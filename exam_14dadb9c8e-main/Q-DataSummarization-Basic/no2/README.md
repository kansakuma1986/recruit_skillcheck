## 問2 特定条件のデータを除外するデータ集計

### 問題
次のフィールド定義にしたがうデータが与えられます。

データの形式はcsvファイルおよびsqliteファイルであり、同等の内容を含んでいます。どちらを使って解答いただいてもかまいません。


**アクセスログデータ：**  
あるサーバに対するアクセスログのデータです。
アクセス元のIPv4アドレスとアクセスのあった年月日時(タイムゾーンは全てJST)が記録されています。
レコード数は5,000件で、csvファイルにはヘッダー行が含まれています。後述するように、[data](data) ディレクトリに配置されているファイルの内容はあくまでも**サンプルデータであることに注意してください。**

| フィールド | 説明 | データベースでの型 |
----|----|----
| ID | 1から始まる一意の連続する整数、半角数字 | INTEGER |
| IP_ADDRESS | アクセス元のIPv4アドレス | TEXT |
| REQUEST_TIME | アクセスのあった"年(YYYY)月(MM)日(DD)時(HH)"形式の日付データ。例:2019年1月10日9時ならば、2019011009 | TEXT |

- csvファイル：「data/accesslog_02.csv」  
- sqliteファイルと対象データ：「data/database\_02.sqlite」の「access\_log」テーブル

ただし、データベースのデータにはマルチバイト文字は含まれてはいません。

これらのデータを読み込んで、次の操作に従って処理したcsvファイルを出力するプログラムまたはsqlのどちらかを作成してください。
（下記の<csvの出力サンプル>を参照）
出力するcsvファイルは、dataディレクトリ配下にファイル名「accesslog_02.answer.csv」として出力してください。

**操作：**
すべてのアクセスログデータに関して、1時間ごとのアクセス数を出してください。
ただし、1時間ごとで同一アクセス元(IPv4アドレス)から10件以上アクセスが記録されているデータレコードは除外して、
アクセス数を出してください。
10件以上アクセスが記録されているデータレコードを除外した結果、アクセス数が0となる場合は0と出力してください。
ここで、アクセス数とは「アクセスログデータ」に存在するデータレコード数のことをあらわします。

出力形式は、
```csv
日時,集計数
```
としてください。  
<出力サンプル> :
```csv
2020011009,11
2020011010,22
2020011011,0
```

出力するcsvファイルには、ヘッダー行は付与しないでください。
出力結果は日付(日時)の昇順で並べ替えてください。

### サンプルデータ

[data](data) ディレクトリには採点で使われるデータと同じフィールド定義に従うサンプルデータを配置してあります。
**フィールドに含まれる値やデータの行数は採点で使われるデータとは異なっています。**
採点時には、同じパスのデータが採点用データに置き換えられた上でプログラムが実行されます。

### 参考実装
csvファイルを読んでファイル出力するだけのプログラムを参考実装として公開しています。
ローカル環境で以下のようにして動かすことができます。

```
$ ./run.sh
```
