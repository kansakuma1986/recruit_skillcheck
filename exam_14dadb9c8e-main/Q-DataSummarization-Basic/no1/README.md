## 問1 特定条件のデータを対象とするデータ集計

### 問題
次のフィールド定義にしたがうデータが与えられます。

データの形式はcsvファイルおよびsqliteファイルであり、同等の内容を含んでいます。どちらを使って解答いただいてもかまいません。


**アクセスログデータ：**  
あるサーバに対するアクセスログのデータです。
アクセス元のIPv4アドレスとアクセスのあった年月日時(タイムゾーンは全てJST)が記録されています。
レコード数は5,000件で、csvファイルにはヘッダー行が含まれています。後述するように、[data](data) ディレクトリに配置されているファイルの内容はあくまでも**サンプルデータであることに注意してください。**

| フィールド | 説明 | データベースでの型 |
----|----|----
| ID | 1から始まる一意の連続する整数、半角数字 | INTEGER |
| IP_ADDRESS | アクセス元のIPv4アドレス | TEXT |
| REQUEST_TIME | アクセスのあった"年(YYYY)月(MM)日(DD)時(HH)"形式の日付データ。例:2019年1月10日9時ならば、2019011009 | TEXT |

- csvファイル：「data/accesslog_01.csv」  
- sqliteファイルと対象データ：「data/database\_01.sqlite」の「access\_log」テーブル

**ボットのIPデータ：**  
ボットと判定されたIPv4アドレスが記録されています。
レコード数は10件で、csvファイルにはヘッダー行が含まれています。後述するように、[data](data) ディレクトリに配置されているファイルの内容はあくまでも**サンプルデータであることに注意してください。**

| フィールド | 説明 | データベースでの型 |
----|----|----
| ID | 1から始まる一意の連続する整数、半角数字 | INTEGER |
| BOT\_IP\_ADDRESS | ボットと判定されたIPv4アドレス | TEXT |

- csvファイル：「data/botlist_01.csv」  
- sqliteファイルと対象データ：「data/database\_01.sqlite」の「bot\_ip\_address」テーブル

ただし、データベースのデータにはマルチバイト文字は含まれてはいません。

これらのデータを読み込んで、次の操作に従って処理したcsvファイルを出力するプログラムまたはsqlのどちらかを作成してください。
（下記の<csvの出力サンプル>を参照）
出力するcsvファイルは、dataディレクトリ配下にファイル名「accesslog_01.answer.csv」として出力してください。

**操作：**
すべてのアクセスログデータに関して、
日付ごとのアクセス数のうち、正常なアクセス数が5割(50%)以上である
日付と正常なアクセス数を集計し、出してください。

ここで、アクセス数とは「アクセスログデータ」に存在するデータレコード数のことであり、
正常なアクセス数とは「アクセスログデータ」に存在するデータレコードのうち「ボットのIPデータ」に存在するIPアドレス以外をアクセス元とするデータレコード数をあらわします。


出力形式は、
```csv
日付,集計数
```
としてください。  
<出力サンプル> :
```csv
20200110,111
20200111,222
```


出力するcsvファイルには、ヘッダー行は付与しないでください。
出力結果は日付の昇順で並べ替えてください。


### サンプルデータ

[data](data) ディレクトリには採点で使われるデータと同じフィールド定義に従うサンプルデータを配置してあります。
**フィールドに含まれる値やデータの行数は採点で使われるデータとは異なっています。**
採点時には、同じパスのデータが採点用データに置き換えられた上でプログラムが実行されます。

### 参考実装
csvファイルを読んでファイル出力するだけのプログラムを参考実装として公開しています。
ローカル環境で以下のようにして動かすことができます。

```
$ ./run.sh
```
